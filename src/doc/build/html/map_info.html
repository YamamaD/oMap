

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Map Info &mdash; oMap v1.0 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="oMap v1.0 documentation" href="index.html" />
    <link rel="prev" title="API" href="api.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="api.html" title="API"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">oMap v1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="map-info">
<h1>Map Info<a class="headerlink" href="#map-info" title="Permalink to this headline">¶</a></h1>
<p>Map Info holds the actual data of the site.</p>
<div class="section" id="module-map.map_info">
<span id="overview"></span><h2>Overview<a class="headerlink" href="#module-map.map_info" title="Permalink to this headline">¶</a></h2>
<p>Holds the data of the map.</p>
<p>It defines the models for the points, layers and comments. And provides methods
to interact with this data.</p>
</div>
<div class="section" id="module-map.map_info.models">
<span id="models"></span><h2>Models<a class="headerlink" href="#module-map.map_info.models" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">miki</span><span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create_user</span><span class="p">(</span><span class="s">&#39;miki&#39;</span><span class="p">,</span> <span class="s">&#39;miki&#39;</span><span class="p">,</span> <span class="s">&#39;miki&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">layer</span><span class="o">=</span><span class="n">Layer</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;first layer&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s">&#39;This is the first layer&#39;</span><span class="p">,</span><span class="n">owner</span><span class="o">=</span><span class="n">miki</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">point</span><span class="o">=</span><span class="n">SimplePoint</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;a point&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s">&#39;This is the first point&#39;</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="n">layer</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                 <span class="n">owner</span><span class="o">=</span><span class="n">miki</span><span class="p">,</span> <span class="n">point</span><span class="o">=...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">=</span><span class="n">layer</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
<span class="go">a point</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">areas</span><span class="o">=</span><span class="n">layer</span><span class="o">.</span><span class="n">areas</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">areas</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span><span class="o">=</span><span class="n">SimpleArea</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;an area&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s">&#39;This is the first area&#39;</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="n">layer</span><span class="p">,</span> 
<span class="go">                                   polygon=....)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">areas</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<dl class="class">
<dt id="map.map_info.models.Area">
<em class="property">class </em><tt class="descclassname">map.map_info.models.</tt><tt class="descname">Area</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/map/map_info/models.html#Area"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#map.map_info.models.Area" title="Permalink to this definition">¶</a></dt>
<dd><p>used to describe an area of authority</p>
<p>Currently not in use.</p>
</dd></dl>

<dl class="class">
<dt id="map.map_info.models.Comment">
<em class="property">class </em><tt class="descclassname">map.map_info.models.</tt><tt class="descname">Comment</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/map/map_info/models.html#Comment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#map.map_info.models.Comment" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents a comment on some point.</p>
<p>represents a text entered by a user as a comment on some point.</p>
<dl class="docutils">
<dt>Class variables:</dt>
<dd><ul class="first last simple">
<li><strong>created</strong>: date of the comment. auto generated field.</li>
<li><strong>author</strong>: the author of the comment.</li>
<li><strong>body</strong>: the text of the comment.</li>
<li><strong>point</strong>: the point that this comment was made on.</li>
</ul>
</dd>
</dl>
<p>Comment model is related to the User model with related_name=&#8217;comments&#8217;.
And related to the point model with related_name=&#8217;comments&#8217;</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All the comments are stored in one table.</p>
</div>
</dd></dl>

<dl class="class">
<dt id="map.map_info.models.Layer">
<em class="property">class </em><tt class="descclassname">map.map_info.models.</tt><tt class="descname">Layer</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/map/map_info/models.html#Layer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#map.map_info.models.Layer" title="Permalink to this definition">¶</a></dt>
<dd><p>Layers model</p>
<p>holds information about the supported layers. each layer has a unique name
which is it&#8217;s primary key. and a reference to the user who created it.</p>
<p>Layer has related key called points that retrieves the points of the
layer.</p>
<dl class="docutils">
<dt>class variables:</dt>
<dd><ul class="first last simple">
<li><strong>name</strong>: layer name, string.</li>
<li><strong>owner</strong>: the user who created the layer, User.</li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="map.map_info.models.Point">
<em class="property">class </em><tt class="descclassname">map.map_info.models.</tt><tt class="descname">Point</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="_modules/map/map_info/models.html#Point"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#map.map_info.models.Point" title="Permalink to this definition">¶</a></dt>
<dd><p>Data holder.</p>
<p>Point instance holds the data and metadata of 1 report. points has an
automatic id as primary key.</p>
<dl class="docutils">
<dt>Point has 2 related names:</dt>
<dd><ul class="first last simple">
<li>User with related_name=&#8217;points&#8217;</li>
<li>Layer with related_name=&#8217;points&#8217;</li>
</ul>
</dd>
<dt>Class variables:</dt>
<dd><ul class="first last simple">
<li><strong>layer</strong>: the layer of the point. determined by the type of data.And defined
by a foreign key to a layer model.</li>
<li><strong>user</strong>: the user who added the point. a foreign key to a User model.</li>
<li><strong>point</strong>: a latitude/ longitude point that represent the place of the data
on the map.</li>
<li><strong>date_added</strong>: date of adding the point to the database. Auto generated      field.</li>
<li><strong>report_date</strong>: the date in which the data where collected.</li>
<li><strong>address</strong>: text field, a human readable address.</li>
<li><strong>subject</strong>: the report subject/title (very short, describes the what the      report is all about).</li>
<li><strong>description</strong>: a short description of the data (few sentences)</li>
<li><strong>file</strong>: DEPRECATED a path to the data file on the hard disk (not in use       currently).</li>
<li><strong>view_count</strong>: counter for how many times the point was viewed.</li>
<li><strong>objects</strong>: used by geodjango. enables geographical queries.</li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-map.map_info.views">
<span id="views"></span><h2>Views<a class="headerlink" href="#module-map.map_info.views" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="map.map_info.views.add_comment">
<tt class="descclassname">map.map_info.views.</tt><tt class="descname">add_comment</tt><big>(</big><em>request</em>, <em>point_id</em><big>)</big><a class="reference internal" href="_modules/map/map_info/views.html#add_comment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#map.map_info.views.add_comment" title="Permalink to this definition">¶</a></dt>
<dd><p>add new comment.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><strong>point_id</strong> &#8211; the id of the point to the the comment to.</td>
</tr>
</tbody>
</table>
<p>handles POST requests. the request is to add a new comment. the request
specifies the comment text. the comment is added to the data base and will
be linked to the point with id= point_id. the author of the comment is the
the user who sent the request.</p>
</dd></dl>

<dl class="function">
<dt id="map.map_info.views.add_point">
<tt class="descclassname">map.map_info.views.</tt><tt class="descname">add_point</tt><big>(</big><em>request</em><big>)</big><a class="reference internal" href="_modules/map/map_info/views.html#add_point"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#map.map_info.views.add_point" title="Permalink to this definition">¶</a></dt>
<dd><p>handles new data addition.</p>
<p>only logged in user that have the permissions to add a point can add points
anonymous user and logged in user with no permissions will be redirected to
error page with a explanation message.</p>
<p>for GET request the method will render add_point.html page and return it.
for POST request the method will check if the data is valid. and if
valid it will add the new data to the data base. otherwise the
add_point.html will be returned to the user with error message.</p>
<p>POST requests includes a data file. the file will be saved to the hard disk
in the following path: media/data/&lt;point.id&gt;/&lt;file&gt;. the file is written
using handle_uploaded_file method.</p>
<p>if the new data is added successfully the user will be redirected to the
home page.</p>
</dd></dl>

<dl class="function">
<dt id="map.map_info.views.get_file">
<tt class="descclassname">map.map_info.views.</tt><tt class="descname">get_file</tt><big>(</big><em>request</em>, <em>file</em><big>)</big><a class="reference internal" href="_modules/map/map_info/views.html#get_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#map.map_info.views.get_file" title="Permalink to this definition">¶</a></dt>
<dd><p>returns static files</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><strong>file</strong> &#8211; relative file path, relative to the media dir.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="map.map_info.views.handle_uploaded_file">
<tt class="descclassname">map.map_info.views.</tt><tt class="descname">handle_uploaded_file</tt><big>(</big><em>f</em>, <em>id</em>, <em>file_name</em><big>)</big><a class="reference internal" href="_modules/map/map_info/views.html#handle_uploaded_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#map.map_info.views.handle_uploaded_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves a file to the disk.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>f</strong> &#8211; file.</li>
<li><strong>id</strong> &#8211; id of the point for the file.</li>
<li><strong>file_name</strong> &#8211; the file name.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The method creates a new directory under media/data with the id as a name    and saves the file (f) to the new directory with the name: file_name.</p>
</dd></dl>

<dl class="function">
<dt id="map.map_info.views.main">
<tt class="descclassname">map.map_info.views.</tt><tt class="descname">main</tt><big>(</big><em>request</em><big>)</big><a class="reference internal" href="_modules/map/map_info/views.html#main"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#map.map_info.views.main" title="Permalink to this definition">¶</a></dt>
<dd><p>returns home page rendered html.</p>
<p>renderer the index.html page according to the context of the request and    returns it to the user.</p>
</dd></dl>

<dl class="function">
<dt id="map.map_info.views.view_detailed">
<tt class="descclassname">map.map_info.views.</tt><tt class="descname">view_detailed</tt><big>(</big><em>request</em>, <em>point_id</em><big>)</big><a class="reference internal" href="_modules/map/map_info/views.html#view_detailed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#map.map_info.views.view_detailed" title="Permalink to this definition">¶</a></dt>
<dd><p>views the full details of a point.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><strong>point_id</strong> &#8211; a point id to view.</td>
</tr>
</tbody>
</table>
<p>returns a rendered page of site/details.html for the received point id.
the point details are retrieved from the data base and the  data file path
is be built and returned.</p>
</dd></dl>

</div>
<div class="section" id="module-map.map_info.forms">
<span id="forms"></span><h2>Forms<a class="headerlink" href="#module-map.map_info.forms" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="map.map_info.forms.AddPointForm">
<em class="property">class </em><tt class="descclassname">map.map_info.forms.</tt><tt class="descname">AddPointForm</tt><big>(</big><em>data=None</em>, <em>files=None</em>, <em>auto_id='id_%s'</em>, <em>prefix=None</em>, <em>initial=None</em>, <em>error_class=&lt;class 'django.forms.util.ErrorList'&gt;</em>, <em>label_suffix=':'</em>, <em>empty_permitted=False</em><big>)</big><a class="reference internal" href="_modules/map/map_info/forms.html#AddPointForm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#map.map_info.forms.AddPointForm" title="Permalink to this definition">¶</a></dt>
<dd><p>New points form.</p>
<dl class="docutils">
<dt>The user has to enter the following details for new points:</dt>
<dd><ul class="first last simple">
<li><strong>later</strong>: chosen from a drop down list.</li>
<li><strong>report_date</strong>: entered manually. but must adhere to the django date format</li>
<li><strong>subject</strong>: point subject. displayed as a text box.</li>
<li><strong>description</strong>: point description. displayed as a text box.</li>
<li><strong>file</strong>: chosen from a file browser window.</li>
<li><strong>point</strong>: represented as latitude and longitude. chosen using map widget</li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="map.map_info.forms.CommentForm">
<em class="property">class </em><tt class="descclassname">map.map_info.forms.</tt><tt class="descname">CommentForm</tt><big>(</big><em>data=None</em>, <em>files=None</em>, <em>auto_id='id_%s'</em>, <em>prefix=None</em>, <em>initial=None</em>, <em>error_class=&lt;class 'django.forms.util.ErrorList'&gt;</em>, <em>label_suffix=':'</em>, <em>empty_permitted=False</em>, <em>instance=None</em><big>)</big><a class="reference internal" href="_modules/map/map_info/forms.html#CommentForm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#map.map_info.forms.CommentForm" title="Permalink to this definition">¶</a></dt>
<dd><p>New comments form</p>
<p>we only need the comment body, comment author are extracted from the    currently logged in user.  date is set to the current date.</p>
</dd></dl>

</div>
<div class="section" id="module-map.map_info.admin">
<span id="admin"></span><h2>Admin<a class="headerlink" href="#module-map.map_info.admin" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="map.map_info.admin.CommentAdmin">
<em class="property">class </em><tt class="descclassname">map.map_info.admin.</tt><tt class="descname">CommentAdmin</tt><big>(</big><em>model</em>, <em>admin_site</em><big>)</big><a class="reference internal" href="_modules/map/map_info/admin.html#CommentAdmin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#map.map_info.admin.CommentAdmin" title="Permalink to this definition">¶</a></dt>
<dd><p>ModelAdmin for the comments</p>
</dd></dl>

<dl class="class">
<dt id="map.map_info.admin.LayerAdmin">
<em class="property">class </em><tt class="descclassname">map.map_info.admin.</tt><tt class="descname">LayerAdmin</tt><big>(</big><em>model</em>, <em>admin_site</em><big>)</big><a class="reference internal" href="_modules/map/map_info/admin.html#LayerAdmin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#map.map_info.admin.LayerAdmin" title="Permalink to this definition">¶</a></dt>
<dd><p>ModelAdmin for the layers</p>
</dd></dl>

<dl class="class">
<dt id="map.map_info.admin.PointAdmin">
<em class="property">class </em><tt class="descclassname">map.map_info.admin.</tt><tt class="descname">PointAdmin</tt><big>(</big><em>model</em>, <em>admin_site</em><big>)</big><a class="reference internal" href="_modules/map/map_info/admin.html#PointAdmin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#map.map_info.admin.PointAdmin" title="Permalink to this definition">¶</a></dt>
<dd><p>ModelAdmin for the points.</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Map Info</a><ul>
<li><a class="reference internal" href="#module-map.map_info">Overview</a></li>
<li><a class="reference internal" href="#module-map.map_info.models">Models</a></li>
<li><a class="reference internal" href="#module-map.map_info.views">Views</a></li>
<li><a class="reference internal" href="#module-map.map_info.forms">Forms</a></li>
<li><a class="reference internal" href="#module-map.map_info.admin">Admin</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="api.html"
                        title="previous chapter">API</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/map_info.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="api.html" title="API"
             >previous</a> |</li>
        <li><a href="index.html">oMap v1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Haitham Khateeb, Yamama Dagash.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
  </body>
</html>